<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="804px" height="1083px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36&quot; version=&quot;5.5.6.2&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><g transform="translate(124.5,2.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="34" height="17" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 36px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 16px">Alice</font></div></div></foreignObject><text x="17" y="15" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,2.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="17" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 16px">Bob</font></div></div></foreignObject><text x="14" y="15" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 32 21 L 32 268.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 32 273.88 L 28.5 266.88 L 32 268.63 L 35.5 266.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1.5,215.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">time</div></div></foreignObject><text x="10" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">time</text></switch></g><g transform="translate(433.5,76.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- registers a Bonjour service on the local network (advertising his IP and port1)</div></div></foreignObject><text x="144" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">- registers a Bonjour service on the local network (advertising his IP and port1)</text></switch></g><g transform="translate(51.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="207" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 208px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- discovers and resolves Bob's service</div></div></foreignObject><text x="104" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">- discovers and resolves Bob's service</text></switch></g><path d="M 152 175 L 572.72 243.97" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 577.9 244.82 L 570.42 247.14 L 572.72 243.97 L 571.56 240.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(203.5,197.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="323" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">partial hash of salted phone number<div>(includes salt, partialHash(phone_number, salt), numBitsRevealed)</div></div></div></foreignObject><text x="162" y="18" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">partial hash of salted phone number&lt;div&gt;(includes salt, partialHash(phone_number, salt), numBitsRevealed)&lt;/div&gt;</text></switch></g><g transform="translate(466.5,246.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="223" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 223px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- checks own phone book against hash, and tries to guess Alice's phone number</div></div></foreignObject><text x="112" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">- checks own phone book against hash, and tries to guess Alice's phone number</text></switch></g><path d="M 579 275 L 149.29 343.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 144.1 344.82 L 150.46 340.26 L 149.29 343.99 L 151.57 347.17 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(260.5,297.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="199" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 1 (where theÂ shared secret<br />is Bob's guess for Alice's phone number)</div></div></foreignObject><text x="100" y="18" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 1 (where the&amp;nbsp;shared secret&lt;br&gt;is Bob's guess for Alice's phone number)</text></switch></g><path d="M 152 345 L 575.71 413.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 580.9 414.82 L 573.43 417.15 L 575.71 413.98 L 574.55 410.24 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(330.5,374.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 1</div></div></foreignObject><text x="37" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 1</text></switch></g><path d="M 142 365 L 575.72 439.92" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 580.9 440.81 L 573.4 443.07 L 575.72 439.92 L 574.6 436.17 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(324.5,396.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 2</div></div></foreignObject><text x="37" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 2</text></switch></g><path d="M 572 415 L 148.31 474.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 143.11 474.85 L 149.56 470.41 L 148.31 474.12 L 150.52 477.34 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(320.5,438.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 2</div></div></foreignObject><text x="37" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 2</text></switch></g><path d="M 582 441 L 148.32 494.22" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 143.11 494.86 L 149.63 490.54 L 148.32 494.22 L 150.48 497.49 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(324.5,462.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 3</div></div></foreignObject><text x="37" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 3</text></switch></g><path d="M 142 475 L 572.71 543.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 577.9 544.82 L 570.43 547.17 L 572.71 543.99 L 571.54 540.26 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(323.5,503.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">JPAKE round 3</div></div></foreignObject><text x="37" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">JPAKE round 3</text></switch></g><g transform="translate(455.5,547.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 246px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- derives high-entropy secret key K from JPAKE and stores it in a hash map - where keys are IP addresses (if JPAKE succeeded)</div></div></foreignObject><text x="123" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 579 591 L 148.32 642.25" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 143.11 642.87 L 149.65 638.57 L 148.32 642.25 L 150.47 645.52 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(311.5,604.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">ACK JPAKE round 3<br />(contains port2)</div></div></foreignObject><text x="49" y="18" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">ACK JPAKE round 3&lt;br&gt;(contains port2)</text></switch></g><g transform="translate(62.5,639.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="158" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 158px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- derives secret key K from JPAKE</div></div></foreignObject><text x="79" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">- derives secret key K from JPAKE</text></switch></g><g transform="translate(42.5,141.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="218" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 218px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>- establishes a TCP connection with Bob on port1</span></div></div></foreignObject><text x="109" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;span&gt;- establishes a TCP connection with Bob on port1&lt;/span&gt;</text></switch></g><g transform="translate(432.5,27.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="284" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 284px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- starts listening on port1 (for plaintext comms), and port2 (for AES encrypted comms)<br /></div></div></foreignObject><text x="142" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">- starts listening on port1 (for plaintext comms), and port2 (for AES encrypted comms)&lt;br&gt;</text></switch></g><path d="M 579 545 L 579 545" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 579 545 L 579 545 L 579 545 L 579 545 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(52.5,681.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 178px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- establishes a new TCP connection with Bob on port2, the old connection gets closed</div></div></foreignObject><text x="89" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 62 739 L 712 739 M 712 743 L 62 743 M 712 743" fill="none" stroke="#000000" stroke-linejoin="round" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(238.5,728.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="297" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">TCP communication is now AES-CFB8-NoPadding encrypted<br />(with symmetric key K, and zero IV)</div></div></foreignObject><text x="149" y="18" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">TCP communication is now AES-CFB8-NoPadding encrypted&lt;br&gt;(with symmetric key K, and zero IV)</text></switch></g><path d="M 142 771 L 580.69 830.15" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 585.89 830.85 L 578.49 833.38 L 580.69 830.15 L 579.42 826.45 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(159.5,788.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="410" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">public key refresh<div>(includes public_key, timestamp, sign(hash(public_key, timestamp, phone_number)))</div></div></div></foreignObject><text x="205" y="18" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">public key refresh&lt;div&gt;(includes public_key, timestamp, sign(hash(public_key, timestamp, phone_number)))&lt;/div&gt;</text></switch></g><g transform="translate(472.5,827.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="228" height="96" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 228px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- after checking self-consistency of the message, checks whether he already knows other public keys for Alice's phone number<br /><div>(if the self-consistency check fails, discards the message, and forcibly closes the TCP connection)</div></div></div></foreignObject><text x="114" y="54" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 522 921 L 472 921 L 472 1031 L 522 1031" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(474.5,927.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="326" height="96" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">- if no public keys are yet associated with the phone number,<div>Bob trusts Alice (trust on first use): accept message</div><div>- if this public key has previously been associated with the</div><div>phone number, we refresh the relevant time stamps: accept</div><div>- if another, different than this, public key is associated with</div><div>the phone number: discard the message, and forcibly close</div><div>the TCP connection</div></div></div></foreignObject><text x="163" y="54" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(287.5,1064.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="164" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 166px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">and now, the history transfer ...</div></div></foreignObject><text x="82" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">and now, the history transfer ...</text></switch></g></g></svg>